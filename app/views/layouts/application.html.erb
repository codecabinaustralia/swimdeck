<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title><%= content_for?(:title) ? yield(:title) : "Untitled" %></title>

    <%= stylesheet_link_tag    "application" %>
    <%= javascript_include_tag "application", 'data-turbolinks-track' => true %>
    <%= csrf_meta_tags %>
    
  </head>

  <body>
    
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
  <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
  <div class="title-bar-title">Menu</div>
</div>

<div class="top-bar" id="responsive-menu">
  <div class="top-bar-left">
    <ul class="dropdown menu" data-dropdown-menu>
      <li class="menu-text-logo"><%= link_to "SWIMDECK", root_path %></li>
      <% if user_signed_in? %>
        <% if current_user.client != true %>
        <li><%= link_to "Daily Planner", daily_planner_path %></li>
        <li><%= link_to "Lessons", lessons_path %></li>
        <li><%= link_to "Students", students_path%></li>
        <% else %>
        <% @client = Client.where(user_id: current_user.id).last %>
        <li><%= link_to "My Children", client_path(@client) %></li>
        <% end %>
      <% end %>

      <% if user_signed_in? %>
        <li>
        <%= link_to('Logout', destroy_user_session_path, method: :delete) %>        
        </li>
      <% else %>
        <li>
        <%= link_to('Login', new_user_session_path)  %>  
        </li>
      <% end %>
    </ul>
  </div>
  <div class="top-bar-right">
    <ul class="dropdown menu">
      <% if user_signed_in? %>
      <% if current_user.client != true %>
      <li><div class="button hollow primary" style="border: 2px solid white; font-weight: bold; color: white; margin-top:15px;" data-open="assign_task">ASSIGN A TASK</div></li>
      <% end %>
      <% end %>

      <div class="off-canvas position-left new-task-offcanvas" id="assign_task" data-off-canvas style="background-color: #29353d;">
        <div class="grid-x grid-padding-x">
          <div class="cell small-12" style="padding-top: 20px;">
            <% @task = Task.new %>
            <h3 style="color: white;">Assign a new task</h3>
            <%= render 'tasks/form', task: @task %>
          </div>
        </div>
      </div>

      <li class="notification-bar text-center">
        <i class="fa fa-bell"></i>
        <% if user_signed_in? %>
        <% @notification_count = Task.where(target_user: current_user.id).where(completed: nil).where("due_date == ?", Time.now.strftime("%Y-%m-%d")).all %>
        <span class="badge alert" style="margin-left: -10px;"><%= @notification_count.count %></span>
        <% end %>
      </li>
      <li>

          <%= link_to user_profiles_pool_deck_leader_path do %>
  
          <div class="nav-bubble">
            <% if user_signed_in? %>
            <% if current_user.avatar.attached? %>
                <%= image_tag(current_user.avatar) %>
            <% else %>
                <img src="https://assets.pepper.ru/assets/img/profile-placeholder_f56af.png">
            <% end %>
            <% end %>
          </div>
        <% end %>
      </li>
    </ul>
  </div>
</div>
    
    <div class="off-canvas-content" data-off-canvas-content>
      <div class="gray-body">
        <%= yield %>
      </div>
    </div>
  </body>
</html>
